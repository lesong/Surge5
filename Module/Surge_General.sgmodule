#!name=lesong@𝐒𝐮𝐫𝐠𝐞𝐏𝐫𝐨 𝐒𝐜𝐫𝐢𝐩𝐭合集
#!desc=𝐔𝐩𝐝𝐚𝐭𝐞: 2023.08.12
# > 花样字体生成： https://qwerty.dev/fancy-font-generator/
# > 机场转义𝐄𝐍𝐂𝐎𝐃𝐄： https://www.urlencoder.org

[General]
force-http-engine-hosts = %APPEND% boxjs.com, boxjs.net, *.boxjs.com, *.boxjs.net
# 跳过代理检测
# www.baidu.com：网上国网、广东农信、丰云行、中国银行缤纷生活、通信行程卡app
# yunbusiness.ccb.com：建行生活
# www.abchina.com.cn：中国农业银行
# login-service.mobile-bank.psbc.com,mobile-bank.psbc.com：中国邮政储蓄银行
# skip-proxy = %APPEND% www.baidu.com,yunbusiness.ccb.com,www.abchina.com.cn,login-service.mobile-bank.psbc.com,mobile-bank.psbc.com

[Header Rewrite]
# > 百度（全站替换为手机百度 Quark 的 User-Agent）
http-request ^https?:\/\/(?!d\.pcs).*(?<!map)\.baidu\.com header-replace-regex User-Agent .+iPhone.+ "Mozilla/5.0 (iPhone; CPU iPhone OS 13_5 like Mac OS X) AppleWebKit/605.1.15 (KHTML, like Gecko) Version/13.1.1 Mobile/15E148 Safari/16C50 Quark/604.1 T7/10.3 SearchCraft/2.6.3 (Baidu; P1 8.0.0)"

# > Revenuecat
https:\/\/api\.revenuecat\.com header-del x-revenuecat-etag

[Rule]
# >> 顶级域名分流
# 大陆顶级域
# DOMAIN-SUFFIX,cn,Direct
# 香港顶级域
DOMAIN-SUFFIX,hk,🇭🇰 香港节点
# 台湾顶级域
DOMAIN-SUFFIX,tw,🇨🇳 台湾节点
DOMAIN-SUFFIX,hinet.net,🇨🇳 台湾节点
DOMAIN-SUFFIX,emome.net,🇨🇳 台湾节点
DOMAIN-SUFFIX,litv.tv,🇨🇳 台湾节点
DOMAIN-SUFFIX,linkedin.com,🇨🇳 台湾节点
# 新加坡顶级域
DOMAIN-SUFFIX,sg,🇸🇬 新加坡节点
# 韩国顶级域
DOMAIN-SUFFIX,kr,🇰🇷 韩国节点
# 日本顶级域
DOMAIN-SUFFIX,jp,🇯🇵 日本节点
# 美国顶级域
DOMAIN-SUFFIX,us,🇺🇲 美国节点
DOMAIN,lb-rdv-steep.ubisoft.com,🇺🇲 美国节点
DOMAIN,useast1-public-ubiservices.ubi.com,🇺🇲 美国节点
DOMAIN,lens.l.google.com,🇺🇲 美国节点
# > 个人分流
DOMAIN,raw.githubusercontent.com,美国1年ss
DOMAIN-KEYWORD,github,美国1年ss
DOMAIN-SUFFIX,sub.store,美国1年ss
# > Safari 防跳转
DOMAIN,app-site-association.cdn-apple.com,REJECT
# > 屏蔽HTTP3/QUIC协议
AND,((PROTOCOL,UDP), (DEST-PORT,443)),REJECT-NO-DROP
# > 拒绝国家反诈中心请求
DOMAIN-SUFFIX,gjfzpt.cn,REJECT
# Boxjs 代理
DOMAIN-KEYWORD,jsdelivr.net,🇺🇲 美国节点
# 屏蔽YouTube的UDP
AND,((PROTOCOL,UDP), (DOMAIN-SUFFIX,googlevideo.com)),REJECT-NO-DROP
# 绕过App企业证书过期
DOMAIN,ocsp.apple.com,Reject
# iQZone 代理
DOMAIN,uuu.glass,🚀 延迟最低
# BT
DOMAIN-SUFFIX,smtp,Direct
DOMAIN-KEYWORD,aria2,Direct
DOMAIN-KEYWORD,announce,Direct
DOMAIN-KEYWORD,tracker,Direct
URL-REGEX,(Subject|HELO|SMTP),Direct
URL-REGEX,(api|ps|sv|offnavi|newvector|ulog.imap|newloc)(.map|).(baidu|n.shifen).com,Direct
# 迅雷
URL-REGEX,(.?)(xunlei|sandai|Thunder|XLLiveUD)(.),Direct
DOMAIN-SUFFIX,xunlei.com,Direct
PROCESS-NAME,DownloadService,Direct
PROCESS-NAME,Weiyun,Direct
PROCESS-NAME,baidunetdisk,Direct
URL-REGEX,(api|ps|sv|offnavi|newvector|ulog\.imap|newloc)(\.map|)\.(baidu|n\.shifen)\.com,Direct
# >> UItra Mobile
DOMAIN-SUFFIX,analytics.amplitude.com,🇺🇲 美国节点
DOMAIN-SUFFIX,api.amplitude.com,🇺🇲 美国节点
DOMAIN-SUFFIX,api2.amplitude.com,🇺🇲 美国节点
DOMAIN-SUFFIX,cdn.amplitude.com,🇺🇲 美国节点
DOMAIN-SUFFIX,info.amplitude.com,🇺🇲 美国节点
DOMAIN-SUFFIX,regionconfig.amplitude.com,🇺🇲 美国节点
DOMAIN-SUFFIX,static.amplitude.com,🇺🇲 美国节点
DOMAIN-SUFFIX,launchdarkly.com,🇺🇲 美国节点
DOMAIN-SUFFIX,ultramobile.com,🇺🇲 美国节点
DOMAIN-KEYWORD,ultramobile.com,🇺🇲 美国节点
# >> target
DOMAIN-SUFFIX,target.com,🇺🇲 美国节点
DOMAIN-SUFFIX,carnivalmobile.com,🇺🇲 美国节点
DOMAIN-KEYWORD,target,🇺🇲 美国节点
# >> bestbuy
DOMAIN-KEYWORD,bestbuy,🇺🇲 美国节点
DOMAIN,pisces.bbystatic.com,🇺🇲 美国节点
# >> 贴吧净化
RULE-SET,https://raw.githubusercontent.com/app2smile/rules/master/rule/tieba-ad.list,REJECT-DROP

[URL Rewrite]
# 将 google.cn 的请求重定向到 google.com
^(http|https):\/\/(www.)?(g|google)\.cn https://www.google.com 307

[Script]
# > BoxJs
Rewrite: BoxJs = type=http-request,pattern=^https?:\/\/(.+\.)?boxjs\.(com|net),script-path=https://raw.githubusercontent.com/chavyleung/scripts/master/box/chavy.boxjs.js, requires-body=true, timeout=120

# > 百度搜索防跳转 App Store by app2smile
百度搜索防跳转 = type=http-response,pattern=^https?\:\/\/boxer\.baidu\.com\/scheme,script-path=https://raw.githubusercontent.com/app2smile/rules/master/js/baidu-no-redirect.js

# > 判断网络是否能够连接谷歌，如果不能则自动切换代理
#proxy_auto_switch = type=event,event-name=network-changed,timeout=10,debug=1,script-path=https://raw.githubusercontent.com/shinyypig/Surge-Scripts/main/scripts/proxy_auto_switch.js

# > 美团外卖去开屏广告 by blackmatrix7
美团外卖去开屏广告 = type=http-response,requires-body=1,max-size=0,pattern=^https?:\/\/wmapi\.meituan\.com\/api\/v\d+\/loadInfo?,script-path=https://raw.githubusercontent.com/blackmatrix7/ios_rule_script/master/script/startup/startup.js

# > 避免 Google 搜索可能出现的人机验证 by NobyDa
Google_CAPTCHA.js = type=http-response,pattern=^https:\/\/www\.google\.com(\.[a-z]+|)\/search\?q=,requires-body=1,debug=0,script-path=https://raw.githubusercontent.com/NobyDa/Script/master/Surge/JS/Google_CAPTCHA.js,max-size=0,timeout=10,ability=http-client-policy,argument=^(🇸🇬|🇭🇰)\s.*\d+$

[MITM]
hostname = %APPEND% g.cn, www.g.cn, google.cn, www.google.cn, boxjs.com, boxjs.net, *.boxjs.com, *.boxjs.net, mbd.baidu.com, boxer.baidu.com, wmapi.meituan.com, www.google.com*
, api.revenuecat.com